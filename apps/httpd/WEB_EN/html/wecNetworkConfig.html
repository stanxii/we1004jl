<html>
	<head>
		<link rel="stylesheet" href='stylemain.css' type='text/css'>
		<link rel="stylesheet" href='colors.css' type='text/css'>
		<!--<meta http-equiv="Pragma" content="no-cache">-->
		<meta http-equiv="Content-Type" content="text/html;charset=utf-8;no-cache">
		<!--<meta http-equiv="refresh" content="20">-->
		<title>EoC</title>
		<base target="_self">
		
		<script language="javascript" src="util.js"></script>
		<script language="javascript">
			function frmLoad() {
			   with ( document.forms[0] ) {
			      ethIpAddress.value = '<%ejGet(wecIpaddr)%>';
			      ethSubnetMask.value = '<%ejGet(wecNetmask)%>';
			      ethGateway.value = '<%ejGet(wecDefaultGw)%>';
			      var state = '<%ejGet(wecMgmtVlanSts)%>';
			      if ( state == '0' )
			      {
			      	enblMgmtVlan.checked = false;
			      	hideMgmtVlanInfo(1);
			      	vlanid.value = '1';
			      }
			      else
			      {
			      	enblMgmtVlan.checked = true;
			      	hideMgmtVlanInfo(0);
			      	vlanid.value = '<%ejGet(wecMgmtVlanId)%>';
			      }
			    }
			}
			function hideMgmtVlanInfo(hide)
			{
			   var status = 'visible';
			
			   if ( hide == 1 )
			      status = 'hidden';
			   if (document.getElementById)  // DOM3 = IE5, NS6
			      document.getElementById('mgmtVlanInfo').style.visibility = status;
			   else {
			      if (document.layers == false) // IE4
			         document.all.mgmtVlanInfo.style.visibility = status;
			   }
			}
			
			function mgmtVlanCbClick(cb)
			{
			   if ( cb.checked == true )
			      hideMgmtVlanInfo(0);
			   else
			      hideMgmtVlanInfo(1);
			}
			
			function btnSave()
			{
				 var loc = 'ntwkcfg.cgi?';

			   with ( document.forms[0] )
			   {
			   		if ( isValidIpAddress(ethIpAddress.value) == false )
			   		{
			   			alert('IP address "' + ethIpAddress.value + '" is invalid.');
			   			return;
			   		}
			   		else
			   		{
			   			loc += 'wecIpaddr=' + ethIpAddress.value;
			   		}
			   		
			   		if ( isValidSubnetMask(ethSubnetMask.value) == false )
			   		{
			   			alert('Subnet mask "' + ethSubnetMask.value + '" is invalid.');	
			   			return;
			   		}
			   		else
			   		{
			   			loc += '&wecNetmask=' + ethSubnetMask.value;
			   		}
			   		
			   		if ( isValidGwAddress(ethGateway.value) == false )
			   		{
			   			alert('Gateway "' + ethGateway.value + '" is invalid.');	
			   			return;
			   		}
			   		else
			   		{
			   			loc += '&wecDefaultGw=' + ethGateway.value;
			   		}			   		
			   		
			   		if ( enblMgmtVlan.checked == true )
			   		{
			   			loc += '&wecMgmtVlanSts=1';
			   			if ( isValidVlanId(vlanid.value) == false )
			   			{
			   				return;
			   			}
			   			else
			   			{
			   				loc += '&wecMgmtVlanId=' + vlanid.value;
			   			}			   			
			   		}
			   		else
			   		{
			   			loc += '&wecMgmtVlanSts=0';
			   			loc += '&wecMgmtVlanId=1';
			   		}
			   }
			
			   var code = 'location="' + loc + '"';			   
			   eval(code);	   
			}
		</script>
	</head>
	
	<body onLoad='frmLoad()'>
		<blockquote>
			<form>
				<br>
        <table border="0" cellpadding="5" cellspacing="0">
        	<tr>
        		<td class='maintitle'><b>Network Settings</b></td>            		
        	</tr>                       
        </table>
        <table border="0" cellpadding="0" cellspacing="0">            	
        	<tr>
						<td class='mainline' width=800></td>
					</tr>                           
        </table>
				<br>Through this page, you can set the management IP address and VLAN of the device. 
				<br>Please login the device by the new IP address and VLAN after the settings to take effect.
				<br>Note: Make sure to save the modified configuration to nonvolatile memory.</br>
				<br>            	
				<br>
				<table border="0" cellpadding="0" cellspacing="0">
		  		<tr>
		  			<td class='diagret' width=300>Network configuration parameters</td>
		  			<td class='diagret' width=260>&nbsp;</td>
		  		</tr>
		  		<tr><td class='diagdata' colspan=2>&nbsp;</td></tr>
		  		<tr>
						<td class='diagdata'>IP Address:</td>
						<td class='diagdata'><input type='text' name='ethIpAddress'></td>
					</tr>
					<tr>
						<td class='diagdata'>Netmask:</td>
						<td class='diagdata'><input type='text' name='ethSubnetMask'></td>
					</tr>
					<tr>
						<td class='diagdata'>Gateway:</td>
						<td class='diagdata'><input type='text' name='ethGateway'></td>
					</tr>
					<tr><td class='diagdata' colspan=2>&nbsp;</td></tr>
					<tr>
						<td class='diagdata'><input type='checkbox' name='enblMgmtVlan' onClick='mgmtVlanCbClick(this)'></td>
						<td class='diagdata'>Enable MGMT-VLAN</td>
					</tr>					  		
		  		<tr><td class='diagdata' colspan=2>&nbsp;</td></tr>		  		
		  	</table>				
				<div id='mgmtVlanInfo'>
					<table border="0" cellpadding="0" cellspacing="0">
						<tr>
							<td class='diagdata' width=300>MGMT VLAN-ID</td>
							<td class='diagdata' width=260><input type='text' name='vlanid'></td>
						</tr>
						<tr><td class='diagdata' colspan=2>&nbsp;</td></tr>						
					</table>
				</div>
				<table border="0" cellpadding="0" cellspacing="0">
		  		<tr><td class='listend' width=560></td></tr>		  		
		  	</table>
		  	<br><b>Note:</b> Network settings will take effect after the system restart.</br>
				<br><br>      
				<p>
					<input type='button' class='btn2L' onClick='btnSave()' value='Commit'>
				</p>
			</form>
		</blockquote>
	</body>
</html>

