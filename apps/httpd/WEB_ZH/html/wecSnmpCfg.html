<html>
	<head>
		<link rel="stylesheet" href='stylemain.css' type='text/css'>
		<link rel="stylesheet" href='colors.css' type='text/css'>
		<meta http-equiv="Content-Type" content="text/html;charset=utf-8;no-cache">
		<title>SNMP设置</title>
		<base target="_self">
		
		<script language="javascript" src="util.js"></script>
		<script language="javascript">
			function frmLoad() {
			   with ( document.forms[0] ) {      
			      rocommunity.value = '<%ejGet(snmpRoCommunity)%>';			      
			      rwcommunity.value = '<%ejGet(snmpRwCommunity)%>'; 			      
			      trapIp.value = '<%ejGet(snmpTrapIpaddr)%>';			      
			      trapPort.value = '<%ejGet(snmpTrapDport)%>';
			   }
			}

			function btnSave()
			{
				 var loc = 'wecSnmpCfgInfo.cgi?';

			   with ( document.forms[0] )
			   {
						if (rocommunity.value == '') {
							alert('Read community is required.');
							return;
						}
						if (rwcommunity.value == '') {
							alert('Set community is required.');
							return;
						}
						if( isValidName(rocommunity.value) == false )
						{
							alert('Read community is invalid.');
							return;
						}
						if (rocommunity.value.length > 32) {
							alert('The length of read community (' + rocommunity.value.length + ') is too long [0-32].');
							return;
						}
						if( isValidName(rwcommunity.value) == false )
						{
							alert('Set community is invalid.');
							return;
						}
						if (rwcommunity.value.length > 32) {
							alert('The length of set community (' + rwcommunity.value.length + ') is too long [0-32].');
							return;
						}
						if ( isValidIpAddress(trapIp.value) == false )
			   		{
			   			alert('Trap server IP address "' + trapIp.value + '" is invalid.');
			   			return;
			   		}
			   		if( isValidUDPPort(trapPort.value) == false )
			   		{
			   			return;	
			   		}						
						loc += 'snmpRoCommunity=' + rocommunity.value;
						loc += '&snmpRwCommunity=' + rwcommunity.value;
						loc += '&snmpTrapIpaddr=' + trapIp.value;
			   		loc += '&snmpTrapDport=' + trapPort.value;
			   }
			
			   var code = 'location="' + loc + '"';			   
			   eval(code);	   
			}
		</script>
	</head>
	
	<body onLoad='frmLoad()'>
		<blockquote>
			<form>
				<br>
        <table border="0" cellpadding="5" cellspacing="0">
        	<tr>
        		<td class='maintitle'><b>SNMP设置</b></td>            		
        	</tr>                       
        </table>
        <table border="0" cellpadding="0" cellspacing="0">            	
        	<tr>
						<td class='mainline' width=800></td>
					</tr>                           
        </table>				
				<br>通过SNMP协议可以完成来自远程服务器的管理，如设备配置的读写以及告警收集等。</br>
				<br>            	
				<br>
				<table border="0" cellpadding="0" cellspacing="0">
					<tr>
		  			<td class='diagret' width=200>SNMP参数设置</td>
		  			<td class='diagret' width=260>&nbsp;</td>
		  		</tr>
		  		<tr><td class='diagdata' colspan=2>&nbsp;</td></tr>
					<tr>
						<td class='diagdata'>只读团体名：</td>
						<td class='diagdata'><input type='text' name='rocommunity' size="20"></td>
					</tr>
					<tr>
						<td class='diagdata'>读写团体名：</td>
						<td class='diagdata'><input type='text' name='rwcommunity' size="20"></td>
					</tr>
					<tr>
						<td class='diagdata'>告警服务器IP地址：</td>
						<td class='diagdata'><input type='text' name='trapIp' size="20"></td>
					</tr>
					<tr>
						<td class='diagdata'>告警服务器接收端口号：</td>
						<td class='diagdata'><input type='text' name='trapPort' size="20"></td>
					</tr>
					<tr><td class='diagdata' colspan=2>&nbsp;</td></tr>
					<tr><td class='listend' colspan=2></td></tr>
				</table>
				<br><b>提示：</b>SNMP参数配置需要在系统重启之后才能生效。</br>				
				<br><br>       
				<p>
					<input type='button' class='btn2L' onClick='btnSave()' value='确 定'>
				</p>
			</form>
		</blockquote>
	</body>
</html>
